<?xml version="1.0" encoding="UTF-8"?> 
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="board">

<select id="listBoard" resultType="map">
	SELECT 
	      BR.BBS_CODE  AS CODE
	    , U.USER_NAME  AS NAME
	    , BR.TITLE     AS TITLE
	    , BR.CONTENT   AS CONTENT
	    , BT.BBS_TYPE  AS TYPE
	    , BR.POST_DATE AS POST_DATE
	    , BR.HIT_COUNT AS HITCOUNT
	    , BL2.COUNT    AS LIKE_COUNT
	FROM BBS_REG BR
	JOIN USER_REG U ON BR.USER_CODE = U.USER_CODE
	JOIN BBS_TYPE BT ON BR.TYPE_CODE = BT.BBS_TYPE_CODE
	JOIN (SELECT BL.BBS_CODE, COUNT(*) AS COUNT FROM BBS_LIKE BL, BBS_REG BR WHERE BL.BBS_CODE = BR.BBS_CODE GROUP BY BR.BBS_CODE) BL2 
	    ON BR.BBS_CODE = BL2.BBS_CODE
	ORDER BY BR.BBS_CODE
</select>

</mapper>